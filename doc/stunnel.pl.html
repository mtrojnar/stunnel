<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv=content-type content="text/html; charset=ISO-8859-2">
<title>stunnel.8</title>
<link rev="made" href="mailto:root@localhost" />
</head>

<body style="background-color: white">

<p><a name="__index__"></a></p>
<!-- INDEX BEGIN -->

<ul>

	<li><a href="#nazwa">NAZWA</a></li>
	<li><a href="#sk³adnia">SK£ADNIA</a></li>
	<li><a href="#opis">OPIS</a></li>
	<li><a href="#opcje">OPCJE</a></li>
	<li><a href="#plik_konfiguracyjny">PLIK KONFIGURACYJNY</a></li>
	<ul>

		<li><a href="#opcje_globalne">OPCJE GLOBALNE</a></li>
		<li><a href="#opcje_us³ug">OPCJE US£UG</a></li>
	</ul>

	<li><a href="#zwracana_warto¶æ">ZWRACANA WARTO¦Æ</a></li>
	<li><a href="#przyk³ady">PRZYK£ADY</a></li>
	<li><a href="#pliki">PLIKI</a></li>
	<li><a href="#b³êdy">B£ÊDY</a></li>
	<li><a href="#ograniczenia">OGRANICZENIA</a></li>
	<li><a href="#notki">NOTKI</a></li>
	<ul>

		<li><a href="#tryb_inetd__tylko_unix_">TRYB INETD (tylko Unix)</a></li>
		<li><a href="#certyfikaty">CERTYFIKATY</a></li>
		<li><a href="#losowo¶æ">LOSOWO¦Æ</a></li>
	</ul>

	<li><a href="#zobacz_równie¿">ZOBACZ RÓWNIE¯</a></li>
	<li><a href="#autor">AUTOR</a></li>
</ul>
<!-- INDEX END -->

<hr />
<p>
</p>
<h1><a name="nazwa">NAZWA</a></h1>
<p>stunnel - uniwersalny tunel protoko³u SSL</p>
<p>
</p>
<hr />
<h1><a name="sk³adnia">SK£ADNIA</a></h1>
<dl>
<dt><strong><a name="item_unix_3a"><strong>Unix:</strong></a></strong><br />
</dt>
<dd>
<strong>stunnel</strong> [plik] | -fd&nbsp;[n] | -help | -version | -sockets
</dd>
<p></p>
<dt><strong><a name="item_win32_3a"><strong>WIN32:</strong></a></strong><br />
</dt>
<dd>
<strong>stunnel</strong> [plik] | -install | -uninstall | -help | -version | -sockets
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="opis">OPIS</a></h1>
<p>Program <strong>stunnel</strong> zosta³ zaprojektowany do opakowywania w protokó³ <em>SSL</em>
po³±czeñ pomiêdzy zdalnymi klientami a lokalnymi lub zdalnymi serwerami.
Przez serwer lokalny rozumiana jest aplikacja przeznaczona do uruchamiania
przy pomocy <em>inetd</em>.
Stunnel pozwala na proste zestawienie komunikacji serwerów nie posiadaj±cych
funkcjonalno¶ci <em>SSL</em> poprzez bezpieczne kana³y <em>SSL</em>.</p>
<p><strong>stunnel</strong> pozwala dodaæ funkcjonalno¶æ <em>SSL</em> do powszechnie stosowanych
demonów <em>inetd</em>, np. <em>pop3</em> lub <em>imap</em>, do samodzielnych demonów,
np. <em>nntp</em>, <em>smtp</em> lub <em>http</em>, a nawet tunelowaæ ppp poprzez gniazda sieciowe
bez zmian w kodzie ¼ród³owym.</p>
<p>
</p>
<hr />
<h1><a name="opcje">OPCJE</a></h1>
<dl>
<dt><strong><a name="item__5bplik_5d"><strong>[plik]</strong></a></strong><br />
</dt>
<dd>
u¿yj podanego pliku konfiguracyjnego
</dd>
<p></p>
<dt><strong><a name="item__2dfd__5bn_5d__28tylko_unix_29"><strong>-fd [n]</strong> (tylko Unix)</a></strong><br />
</dt>
<dd>
wczytaj konfiguracjê z podanego deskryptora pliku
</dd>
<p></p>
<dt><strong><a name="item__2dhelp"><strong>-help</strong></a></strong><br />
</dt>
<dd>
drukuj listê wspieranych opcji
</dd>
<p></p>
<dt><strong><a name="item__2dversion"><strong>-version</strong></a></strong><br />
</dt>
<dd>
drukuj wersjê programu i domy¶lne warto¶ci parametrów
</dd>
<p></p>
<dt><strong><a name="item__2dsockets"><strong>-sockets</strong></a></strong><br />
</dt>
<dd>
drukuj domy¶lne opcje gniazd
</dd>
<p></p>
<dt><strong><a name="item_install"><strong>-install</strong> (tylko NT/2000/XP)</a></strong><br />
</dt>
<dd>
instaluj serwis NT
</dd>
<p></p>
<dt><strong><a name="item_uninstall"><strong>-uninstall</strong> (tylko NT/2000/XP)</a></strong><br />
</dt>
<dd>
odinstaluj serwis NT
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="plik_konfiguracyjny">PLIK KONFIGURACYJNY</a></h1>
<p>Linia w pliku konfiguracyjnym mo¿e byæ:</p>
<ul>
<li></li>
pusta (ignorowana)
<p></p>
<li></li>
komentarzem rozpoczynaj±cym siê znakiem ';' (ignorowana)
<p></p>
<li></li>
par± 'nazwa_opcji = warto¶æ_opcji'
<p></p>
<li></li>
tekstem '[nazwa_us³ugi]' wskazuj±cym pocz±tek definicji us³ugi
<p></p></ul>
<p>
</p>
<h2><a name="opcje_globalne">OPCJE GLOBALNE</a></h2>
<dl>
<dt><strong><a name="item_capath__3d_katalog_ca"><strong>CApath</strong> = katalog_CA</a></strong><br />
</dt>
<dd>
katalog Centrum Certyfikacji
</dd>
<dd>
<p>Opcja okre¶la katalog, w którym <strong>stunnel</strong> bêdzie szuka³ certyfikatów,
je¿eli u¿yta zosta³a opcja <em>verify</em>.  Pliki z certyfikatami musz±
posiadaæ specjalne nazwy XXXXXXXX.0, gdzie XXXXXXXX jest skrótem
certyfikatu.</p>
</dd>
<dd>
<p>Je¿eli zdefiniowano katalog <em>chroot</em>, to ¶cie¿ka do <em>CApath</em> jest okre¶lona
wzglêdem tego katalogu.</p>
</dd>
<p></p>
<dt><strong><a name="item_cafile__3d_plik_ca"><strong>CAfile</strong> = plik_CA</a></strong><br />
</dt>
<dd>
plik Centrum Certyfikacji
</dd>
<dd>
<p>Opcja pozwala okre¶liæ po³o¿enie pliku zawieraj±cego certyfikaty u¿ywane
przez opcjê <em>verify</em>.</p>
</dd>
<p></p>
<dt><strong><a name="item_cert__3d_plik_pem"><strong>cert</strong> = plik_pem</a></strong><br />
</dt>
<dd>
plik z ³añcuchem certyfikatów
</dd>
<dd>
<p>Opcja okre¶la po³o¿enie pliku zawieraj±cego certyfikaty u¿ywane przez
program <strong>stunnel</strong> do uwierzytelnienia siê przed drug± stron± po³±czenia.
Certyfikat jest konieczny, aby u¿ywaæ programu w trybie serwera.
W trybie klienta certyfikat jest opcjonalny.</p>
</dd>
<p></p>
<dt><strong><a name="item_katalog"><strong>chroot</strong> = katalog (tylko Unix)</a></strong><br />
</dt>
<dd>
katalog roboczego korzenia systemu plików
</dd>
<dd>
<p>Opcja okre¶la katalog, w którym uwiêziony zostanie proces programu
<strong>stunnel</strong> tu¿ po jego inicjalizacji, a przed rozpoczêciem odbierania
po³±czeñ.  ¦cie¿ki podane w opcjach <em>CApath</em>, <em>CRLpath</em>, <em>pid</em>
oraz <em>exec</em> musz± byæ umieszczone wewn±trz katalogu podanego w opcji
<em>chroot</em> i okre¶lone wzglêdem tego katalogu.</p>
</dd>
<dd>
<p>W przypadku wykorzystania kontroli dostêpu przy pomocy biblioteki
libwrap (TCP wrappers) jej pliki konfiguracyjne (/etc/hosts.allow i
/etc/hosts.deny) musz± zostaæ skopiowane do podkatalogu etc/
umieszczonego wewn±trz katalogu podanego w opcji <em>chroot</em>.</p>
</dd>
<p></p>
<dt><strong><a name="item_ciphers__3d_lista_szyfrów"><strong>ciphers</strong> = lista_szyfrów</a></strong><br />
</dt>
<dd>
lista dozwolonych szyfrów SSL
</dd>
<dd>
<p>Parametrem tej opcji jest lista szyfrów, które bêd± u¿yte przy
otwieraniu nowych po³±czeñ SSL, np.:  DES-CBC3-SHA:IDEA-CBC-MD5</p>
</dd>
<p></p>
<dt><strong><a name="item_client__3d_yes__7c_no"><strong>client</strong> = yes | no</a></strong><br />
</dt>
<dd>
tryb kliencki (zdalna us³uga u¿ywa SSL)
</dd>
<dd>
<p>domy¶lnie: no (tryb serwerowy)</p>
</dd>
<p></p>
<dt><strong><a name="item_compression__3d_zlib__7c_rle"><strong>compression</strong> = zlib | rle</a></strong><br />
</dt>
<dd>
wybór algorytmu kompresji przesy³anych danych
</dd>
<dd>
<p>domy¶lnie: bez kompresji</p>
</dd>
<p></p>
<dt><strong><a name="item_crlpath__3d_katalog_crl"><strong>CRLpath</strong> = katalog_CRL</a></strong><br />
</dt>
<dd>
katalog List Odwo³anych Certyfikatów (CRL)
</dd>
<dd>
<p>Opcja okre¶la katalog, w którym <strong>stunnel</strong> bêdzie szuka³ list CRL,
je¿eli u¿yta zosta³a opcja <em>verify</em>.  Pliki z listami CRL musz±
posiadaæ specjalne nazwy XXXXXXXX.0, gdzie XXXXXXXX jest skrótem
listy CRL.</p>
</dd>
<dd>
<p>Je¿eli zdefiniowano katalog <em>chroot</em>, to ¶cie¿ka do <em>CRLpath</em> jest okre¶lona
wzglêdem tego katalogu.</p>
</dd>
<p></p>
<dt><strong><a name="item_crlfile__3d_plik_crl"><strong>CRLfile</strong> = plik_CRL</a></strong><br />
</dt>
<dd>
plik List Odwo³anych Certyfikatów (CRL)
</dd>
<dd>
<p>Opcja pozwala okre¶liæ po³o¿enie pliku zawieraj±cego listy CRL u¿ywane
przez opcjê <em>verify</em>.</p>
</dd>
<p></p>
<dt><strong><a name="item_debug__3d_poziom_5b_2epodsystem_5d"><strong>debug</strong> = poziom[.podsystem]</a></strong><br />
</dt>
<dd>
szczegó³owo¶æ logowania
</dd>
<dd>
<p>Poziom logowania mo¿na okre¶liæ przy pomocy jednej z nazw lub liczb:
emerg (0), alert (1), crit (2), err (3), warning (4), notice (5),
info (6) lub debug (7).
Zapisywane s± komunikaty o poziomie ni¿szym (numerycznie) lub równym podanemu.
Do uzyskania najwy¿szego poziomu szczegó³owo¶ci mo¿na u¿yæ opcji
<strong>debug = debug</strong> lub <strong>debug = 7</strong>.  Domy¶lnym poziomem jest notice (5).</p>
</dd>
<dd>
<p>O ile nie wyspecyfikowano podsystemu u¿yty bêdzie domy¶lny: daemon.
Podsystemy nie s± wspierane przez platformê Win32.</p>
</dd>
<dd>
<p>Wielko¶æ liter jest ignorowana zarówno dla poziomu jak podsystemu.</p>
</dd>
<p></p>
<dt><strong><a name="item_¶cie¿ka_do_egd"><strong>EGD</strong> = ¶cie¿ka_do_EGD (tylko Unix)</a></strong><br />
</dt>
<dd>
¶cie¿ka do gniazda programu Entropy Gathering Daemon
</dd>
<dd>
<p>Opcja pozwala okre¶liæ ¶cie¿kê do gniazda programu Entropy Gathering Daemon
u¿ywanego do zainicjalizowania generatora ci±gów pseudolosowych biblioteki
OpenSSL.  Opcja jest dostêpna z bibliotek± OpenSSL 0.9.5a lub nowsz±.</p>
</dd>
<p></p>
<dt><strong><a name="item_engine__3d_auto__7c__3cidentyfikator_urz±dzenia_3e"><strong>engine</strong> = auto | &lt;identyfikator urz±dzenia&gt;</a></strong><br />
</dt>
<dd>
wybór sprzêtowego urz±dzenia kryptograficznego
</dd>
<dd>
<p>domy¶lnie: bez wykorzystania urz±dzeñ kryptograficznych</p>
</dd>
<p></p>
<dt><strong><a name="item_no"><strong>foreground</strong> = yes | no (tylko Unix)</a></strong><br />
</dt>
<dd>
tryb pierwszoplanowy
</dd>
<dd>
<p>U¿ycie tej opcji powoduje, ¿e <em>stunnel</em> nie przechodzi w t³o loguj±c
swoje komunikaty na konsolê zamiast przez <em>syslog</em> (o ile nie u¿yto
opcji <em>output</em>).</p>
</dd>
<p></p>
<dt><strong><a name="item_key__3d_plik_klucza"><strong>key</strong> = plik_klucza</a></strong><br />
</dt>
<dd>
klucz prywatny do certyfikatu podanego w opcji <em>cert</em>
</dd>
<dd>
<p>Klucz prywatny jest potrzebny do uwierzytelnienia w³a¶ciciela certyfikatu.
Poniewa¿ powinien on byæ zachowany w tajemnicy, prawa do jego odczytu
powinien mieæ wy³±cznie w³a¶ciciel pliku.  W systemie Unix mo¿na to osi±gn±æ
komend±:</p>
</dd>
<dd>
<pre>
    chmod 600 keyfile</pre>
</dd>
<dd>
<p>domy¶lnie: warto¶æ opcji <em>cert</em></p>
</dd>
<p></p>
<dt><strong><a name="item_options__3d_opcje_ssl"><strong>options</strong> = opcje_SSL</a></strong><br />
</dt>
<dd>
opcje biblioteki OpenSSL
</dd>
<dd>
<p>Parametrem jest nazwa opcji zgodnie z opisem w <em>SSL_CTX_set_options(3ssl)</em>,
ale bez przedrostka <em>SSL_OP_</em>.
Aby wyspecyfikowaæ kilka opcji nale¿y u¿yæ <em>options</em> wielokrotnie.</p>
</dd>
<dd>
<p>Na przyk³ad dla zachowania kompatybilno¶ci z b³êdami implementacji SSL
w programie Eudora mo¿na u¿yæ opcji:</p>
</dd>
<dd>
<pre>
    options = DONT_INSERT_EMPTY_FRAGMENTS</pre>
</dd>
<p></p>
<dt><strong><a name="item_output__3d_plik"><strong>output</strong> = plik</a></strong><br />
</dt>
<dd>
plik, do którego dopisane zostan± logi
</dd>
<dd>
<p>U¿ycie tej opcji zmienia domy¶lne zachowanie programu polegaj±ce
na logowaniu swoich komunikatów poprzez syslog.</p>
</dd>
<dd>
<p>Do przekierowania komunikatów na standardowe wyj¶cie (na przyk³ad po to,
¿eby zalogowaæ je programem splogger z pakietu daemontools) mo¿na podaæ
jako parametr urz±dzenie /dev/stdout.</p>
</dd>
<p></p>
<dt><strong><a name="item_plik"><strong>pid</strong> = plik (tylko Unix)</a></strong><br />
</dt>
<dd>
po³o¿enie pliku z numerem procesu
</dd>
<dd>
<p>Je¿eli argument jest pusty plik nie zostanie stworzony.</p>
</dd>
<dd>
<p>Je¿eli zdefiniowano katalog <em>chroot</em>, to ¶cie¿ka do <em>pid</em> jest okre¶lona
wzglêdem tego katalogu.</p>
</dd>
<p></p>
<dt><strong><a name="item_rndbytes__3d_liczba_bajtów"><strong>RNDbytes</strong> = liczba_bajtów</a></strong><br />
</dt>
<dd>
liczba bajtów do zainicjowania generatora pseudolosowego
</dd>
<dd>
<p>W wersjach biblioteki OpenSSL starszych ni¿ 0.9.5a opcja ta okre¶la
równie¿ liczbê bajtów wystarczaj±cych do zainicjowania PRNG.
Nowsze wersje biblioteki maj± wbudowan± funkcjê okre¶laj±c±, czy
dostarczona ilo¶æ losowo¶ci jest wystarczaj±ca do zainicjowania generatora.</p>
</dd>
<p></p>
<dt><strong><a name="item_rndfile__3d_plik"><strong>RNDfile</strong> = plik</a></strong><br />
</dt>
<dd>
¶cie¿ka do pliku zawieraj±cego losowe dane
</dd>
<dd>
<p>Biblioteka OpenSSL u¿yje danych z tego pliku do zainicjowania
generatora pseudolosowego.</p>
</dd>
<p></p>
<dt><strong><a name="item_rndoverwrite__3d_yes__7c_no"><strong>RNDoverwrite</strong> = yes | no</a></strong><br />
</dt>
<dd>
nadpisz plik nowymi warto¶ciami pseudolosowymi
</dd>
<dd>
<p>domy¶lnie: yes (nadpisz)</p>
</dd>
<p></p>
<dt><strong><a name="item_service__3d_nazwa_serwisu"><strong>service</strong> = nazwa_serwisu</a></strong><br />
</dt>
<dd>
u¿yj parametru jako nazwy serwisu
</dd>
<dd>
<p><strong>Unix:</strong> nazwa serwisu dla biblioteki TCP Wrapper w trybie <em>inetd</em>.</p>
</dd>
<dd>
<p><strong>NT/2000/XP:</strong> nazwa serwisu NT w Panelu Sterowania.</p>
</dd>
<dd>
<p>domy¶lnie: stunnel</p>
</dd>
<p></p>
<dt><strong><a name="item_session__3d_przeterminowanie_pamiêci_podrêcznej_se"><strong>session</strong> = przeterminowanie_pamiêci_podrêcznej_sesji</a></strong><br />
</dt>
<dd>
czas w sekundach, po którym sesja SSL zostanie usuniêta z pamiêci podrêcznej
</dd>
<p></p>
<dt><strong><a name="item_identyfikator_grupy"><strong>setgid</strong> = identyfikator_grupy (tylko Unix)</a></strong><br />
</dt>
<dd>
grupa z której prawami pracowa³ bêdzie <em>stunnel</em>
</dd>
<p></p>
<dt><strong><a name="item_identyfikator_u¿ytkownika"><strong>setuid</strong> = identyfikator_u¿ytkownika (tylko Unix)</a></strong><br />
</dt>
<dd>
u¿ytkownik, z którego prawami pracowa³ bêdzie <em>stunnel</em>
</dd>
<p></p>
<dt><strong><a name="item_socket__3d_a_7cl_7cr_3aoption_3dvalue_5b_3avalue_5"><strong>socket</strong> = a|l|r:option=value[:value]</a></strong><br />
</dt>
<dd>
ustaw opcjê na akceptuj±cym/lokalnym/zdalnym gnie¼dzie
</dd>
<dd>
<p>Dla opcji linger warto¶ci maj± postaæ l_onof:l_linger.
Dla opcji time warto¶ci maj± postaæ tv_sec:tv_usec.</p>
</dd>
<dd>
<p>Przyk³ady:</p>
</dd>
<dd>
<pre>
    socket = l:SO_LINGER=1:60
        ustaw jednominutowe przeterminowanie
        przy zamykaniu lokalnego gniazda
    socket = r:TCP_NODELAY=1
        wy³±cz algorytm Nagle'a na zdalnych
        gniazdach
    socket = r:SO_OOBINLINE=1
        umie¶æ dane pozapasmowe (out-of-band)
        bezpo¶rednio w strumieniu danych
        wej¶ciowych dla zdalnych gniazd
    socket = a:SO_REUSEADDR=0
        zablokuj ponowne u¿ywanie portu
        (domy¶lnie w³±czone)
    socket = a:SO_BINDTODEVICE=lo
        przyjmuj po³±czenia wy³±cznie na
        interfejsie zwrotnym (ang. loopback)</pre>
</dd>
<p></p>
<dt><strong><strong>taskbar</strong> = yes | no (tylko WIN32)</strong><br />
</dt>
<dd>
w³±cz ikonkê w prawym dolnym rogu ekranu
</dd>
<dd>
<p>domy¶lnie: yes (w³±cz)</p>
</dd>
<p></p>
<dt><strong><a name="item_verify__3d_poziom"><strong>verify</strong> = poziom</a></strong><br />
</dt>
<dd>
weryfikuj certyfikat drugiej strony po³±czenia
</dd>
<dd>
<pre>
    poziom 1 - weryfikuj, je¿eli zosta³
        przedstawiony
    poziom 2 - weryfikuj z zainstalowanym
        certyfikatem Centrum Certyfikacji
    poziom 3 - weryfikuj z lokalnie
        zainstalowanym certyfikatem drugiej strony
    domy¶lnie - nie weryfikuj</pre>
</dd>
<p></p></dl>
<p>
</p>
<h2><a name="opcje_us³ug">OPCJE US£UG</a></h2>
<p>Ka¿da sekcja konfiguracji us³ugi zaczyna siê jej nazw± ujêt± w nawias
kwadratowy.  Nazwa us³ugi u¿ywana jest do kontroli dostêpu przez
bibliotekê libwrap (TCP wrappers) oraz pozwala rozró¿niæ poszczególne
us³ugi w logach.</p>
<p>Je¿eli <strong>stunnel</strong> ma zostaæ u¿yty w trybie <em>inetd</em>, gdzie za odebranie
po³±czenia odpowiada osobny program (zwykle <em>inetd</em>, <em>xinetd</em>
lub <em>tcpserver</em>), nale¿y przeczytaæ sekcjê <strong>TRYB INETD</strong> poni¿ej.</p>
<dl>
<dt><strong><a name="item_accept__3d__5badres_3a_5dport"><strong>accept</strong> = [adres:]port</a></strong><br />
</dt>
<dd>
nas³uchuje na po³±czenia na podanym adresie i porcie
</dd>
<dd>
<p>Je¿eli nie zosta³ podany adres, <em>stunnel</em> domy¶lnie nas³uchuje
na wszystkich adresach IP lokalnych interfejsów.</p>
</dd>
<p></p>
<dt><strong><a name="item_connect__3d__5badres_3a_5dport"><strong>connect</strong> = [adres:]port</a></strong><br />
</dt>
<dd>
po³±cz siê ze zdalnym serwerem na podany port
</dd>
<dd>
<p>Je¿eli nie zosta³ podany adres, <em>stunnel</em> domy¶lnie ³±czy siê
z lokalnym serwerem.</p>
</dd>
<p></p>
<dt><strong><a name="item_delay__3d_yes__7c_no"><strong>delay</strong> = yes | no</a></strong><br />
</dt>
<dd>
opó¼nij rozwiniêcie adresu DNS podanego w opcji <em>connect</em>
</dd>
<p></p>
<dt><strong><a name="item_¶cie¿ka_do_programu"><strong>exec</strong> = ¶cie¿ka_do_programu (tylko Unix)</a></strong><br />
</dt>
<dd>
wykonaj lokalny program przystosowany do pracy z superdemonem inetd
</dd>
<dd>
<p>Je¿eli zdefiniowano katalog <em>chroot</em>, to ¶cie¿ka do <em>exec</em> jest okre¶lona
wzglêdem tego katalogu.</p>
</dd>
<p></p>
<dt><strong><a name="item_execargs__3d__240__241__242__2e_2e_2e__28tylko_uni"><strong>execargs</strong> = $0 $1 $2 ... (tylko Unix)</a></strong><br />
</dt>
<dd>
argumenty do opcji <em>exec</em> w³±cznie z nazw± programu ($0)
</dd>
<dd>
<p>Cytowanie nie jest wspierane w obecnej wersji programu.
Argumenty s± rozdzielone dowoln± liczb± bia³ych znaków.</p>
</dd>
<p></p>
<dt><strong><a name="item_ident__3d_nazwa_u¿ytkownika"><strong>ident</strong> = nazwa_u¿ytkownika</a></strong><br />
</dt>
<dd>
weryfikuj nazwê zdalnego u¿ytkownika korzystaj±c z protoko³u IDENT (RFC 1413)
</dd>
<p></p>
<dt><strong><a name="item_local__3d_serwer"><strong>local</strong> = serwer</a></strong><br />
</dt>
<dd>
IP ¼ród³a do nawi±zywania zdalnych po³±czeñ
</dd>
<dd>
<p>Domy¶lnie u¿ywane jest IP najbardziej zewnêtrznego interfejsu w stronê
serwera, do którego nawi±zywane jest po³±czenie.</p>
</dd>
<p></p>
<dt><strong><a name="item_protocol__3d_protokó³"><strong>protocol</strong> = protokó³</a></strong><br />
</dt>
<dd>
negocjuj SSL podanym protoko³em aplikacyjnym
</dd>
<dd>
<p>aktualnie wspierane protoko³y: cifs, nntp, pop3, smtp</p>
</dd>
<p></p>
<dt><strong><strong>pty</strong> = yes | no (tylko Unix)</strong><br />
</dt>
<dd>
alokuj pseudoterminal dla programu uruchamianego w opcji 'exec'
</dd>
<p></p>
<dt><strong><a name="item_timeoutbusy__3d_liczba_sekund"><strong>TIMEOUTbusy</strong> = liczba_sekund</a></strong><br />
</dt>
<dd>
czas oczekiwania na spodziewane dane
</dd>
<p></p>
<dt><strong><a name="item_timeoutclose__3d_liczba_sekund"><strong>TIMEOUTclose</strong> = liczba_sekund</a></strong><br />
</dt>
<dd>
czas oczekiwania na close_notify (ustaw na 0, je¿eli klientem jest MSIE)
</dd>
<p></p>
<dt><strong><a name="item_timeoutconnect__3d_liczba_sekund"><strong>TIMEOUTconnect</strong> = liczba_sekund</a></strong><br />
</dt>
<dd>
czas oczekiwania na nawi±zanie po³±czenia
</dd>
<p></p>
<dt><strong><a name="item_timeoutidle__3d_liczba_sekund"><strong>TIMEOUTidle</strong> = liczba_sekund</a></strong><br />
</dt>
<dd>
maksymalny czas utrzymywania bezczynnego po³±czenia
</dd>
<p></p>
<dt><strong><strong>transparent</strong> = yes | no (tylko Unix)</strong><br />
</dt>
<dd>
tryb przezroczystego proxy
</dd>
<dd>
<p>Przepisz adres, aby nawi±zywane po³±czenie wydawa³o siê pochodziæ
bezpo¶rednio od klienta, a nie od programu <em>stunnel</em>.
Opcja dzia³a tylko w trybie lokalnym (opcja <em>exec</em>) przez za³adowanie
przy pomocy LD_PRELOAD biblioteki env.so, albo w trybie zdalnym (opcja
<em>connect</em>) na systemie Linux 2.2 z w³±czon± opcj± <em>transparent proxy</em>.</p>
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="zwracana_warto¶æ">ZWRACANA WARTO¦Æ</a></h1>
<p><strong>stunnel</strong> zwraca zero w przypadku sukcesu, lub warto¶æ niezerow±
w przypadku b³êdu.</p>
<p>
</p>
<hr />
<h1><a name="przyk³ady">PRZYK£ADY</a></h1>
<p>Szyfrowanie po³±czeñ do lokalnego serwera <em>imapd</em> mo¿na u¿yæ:</p>
<pre>
    [imapd]
    accept = 993
    exec = /usr/sbin/imapd
    execargs = imapd</pre>
<p>albo w trybie zdalnym:</p>
<pre>
    [imapd]
    accept = 993
    connect = 143</pre>
<p>W po³±czeniu z programem <em>pppd</em> <strong>stunnel</strong> pozwala zestawiæ prosty VPN.
Po stronie serwera nas³uchuj±cego na porcie 2020 jego konfiguracja
mo¿e wygl±daæ nastêpuj±co:</p>
<pre>
    [vpn]
    accept = 2020
    exec = /usr/sbin/pppd
    execargs = pppd local
    pty = yes</pre>
<p>Poni¿szy plik konfiguracyjny mo¿e byæ wykorzystany do uruchomienia
programu <strong>stunnel</strong> w trybie <em>inetd</em>.  Warto zauwa¿yæ, ¿e w pliku
konfiguracyjnym nie ma sekcji <em>[nazwa_us³ugi]</em>.</p>
<pre>
    exec = /usr/sbin/imapd
    execargs = imapd</pre>
<p>
</p>
<hr />
<h1><a name="pliki">PLIKI</a></h1>
<dl>
<dt><strong><a name="item_stunnel_2econf"><em>stunnel.conf</em></a></strong><br />
</dt>
<dd>
plik konfiguracyjny programu
</dd>
<p></p>
<dt><strong><a name="item_stunnel_2epem"><em>stunnel.pem</em></a></strong><br />
</dt>
<dd>
certyfikat i klucz prywatny
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="b³êdy">B£ÊDY</a></h1>
<p>Opcja <em>execargs</em> nie obs³uguje cytowania.</p>
<p>
</p>
<hr />
<h1><a name="ograniczenia">OGRANICZENIA</a></h1>
<p><em>stunnel</em> nie mo¿e byæ u¿ywany do szyfrowania protoko³u <em>FTP</em>,
poniewa¿ do przesy³ania poszczególnych plików u¿ywa on dodatkowych
po³±czeñ otwieranych na portach o dynamicznie przydzielanych numerach.
Istniej± jednak specjalne wersje klientów i serwerów FTP pozwalaj±ce
na szyfrowanie przesy³anych danych przy pomocy protoko³u <em>SSL</em>.</p>
<p>
</p>
<hr />
<h1><a name="notki">NOTKI</a></h1>
<p>
</p>
<h2><a name="tryb_inetd__tylko_unix_">TRYB INETD (tylko Unix)</a></h2>
<p>W wiêkszo¶ci zastosowañ <strong>stunnel</strong> samodzielnie nas³uchuje na porcie
podanym w pliku konfiguracyjnym i tworzy po³±czenie z innym portem
podanym w opcji <em>connect</em> lub nowym programem podanym w opcji <em>exec</em>.
Niektórzy wol± jednak wykorzystywaæ oddzielny program, który odbiera
po³±czenia, po czym uruchamia program <strong>stunnel</strong>.  Przyk³adami takich
programów s± inetd, xinetd i tcpserver.</p>
<p>Przyk³adowa linia pliku /etc/inetd.conf mo¿e wygl±daæ tak:</p>
<pre>
    imaps stream tcp nowait root /usr/sbin/stunnel
        stunnel /etc/stunnel/imaps.conf</pre>
<p>Poniewa¿ w takich przypadkach po³±czenie na zdefiniowanym porcie
(tutaj <em>imaps</em>) nawi±zuje osobny program (tutaj <em>inetd</em>), <strong>stunnel</strong>
nie mo¿e u¿ywaæ opcji <em>accept</em>.  W pliku konfiguracyjnym nie mo¿e
byæ równie¿ zdefiniowana ¿adna us³uga (<em>[nazwa_us³ugi]</em>), poniewa¿
konfiguracja taka pozwala na nawi±zanie tylko jednego po³±czenia.
Wszystkie <em>OPCJE US£UG</em> powinny byæ umieszczone razem z opcjami
globalnymi.  Przyk³ad takiej konfiguracji znajduje siê w sekcji
<em>PRZYK£ADY</em>.</p>
<p>
</p>
<h2><a name="certyfikaty">CERTYFIKATY</a></h2>
<p>Protokó³ SSL wymaga, aby ka¿dy serwer przedstawia³ siê nawi±zuj±cemu
po³±czenie klientowi prawid³owym certyfikatem X.509.
Potwierdzenie to¿samo¶ci serwera polega na wykazaniu, ¿e posiada on
odpowiadaj±cy certyfikatowi klucz prywatny.
Najprostsz± metod± uzyskania certyfikatu jest wygenerowanie
go przy pomocy wolnego pakietu <em>OpenSSL</em>.  Wiêcej informacji na temat
generowania certyfikatów mo¿na znale¼æ na umieszczonych poni¿ej stronach.</p>
<p>Przy generowaniu par certyfikat-klucz dla programu <strong>stunnel</strong> istotne
s± dwie kwestie.  Po pierwsze klucz prywatny nie mo¿e byæ zaszyfrowany,
poniewa¿ startuj±cy serwer nie ma w ogólnym przypadku mo¿liwo¶ci
uzyskania has³a od u¿ytkownika.  Do wytworzenia niezaszyfrowanego
klucza nale¿y przy uruchamianiu komendy <em>openssl req</em>
podaæ jej parametr <em>-nodes</em>.</p>
<p>Drug± istotn± kwesti± jest kolejno¶æ zawarto¶ci pliku <em>.pem</em>.
W pierwszej kolejno¶ci powinien on zawieraæ klucz prywatny,
a dopiero za nim podpisany certyfikat (nie ¿±danie certyfikatu).
Po certyfikacie i kluczu prywatnym powinny znajdowaæ siê puste linie.
Je¿eli przed certyfikatem znajduj± siê dodatkowe informacje tekstowe,
to powinny one zostaæ usuniête.  Otrzymany plik powinien mieæ
nastêpuj±c± postaæ:</p>
<pre>
    -----BEGIN RSA PRIVATE KEY-----
    [zakodowany klucz]
    -----END RSA PRIVATE KEY-----
    [pusta linia]
    -----BEGIN CERTIFICATE-----
    [zakodowany certyfikat]
    -----END CERTIFICATE-----
    [pusta linia]</pre>
<p>
</p>
<h2><a name="losowo¶æ">LOSOWO¦Æ</a></h2>
<p><strong>stunnel</strong> potrzebuje zainicjowaæ PRNG (generator liczb pseudolosowych),
gdy¿ protokó³ SSL wymaga do bezpieczeñstwa kryptograficznego ¼ród³a
dobrej losowo¶ci.  Nastêpuj±ce ¼ród³a s± kolejno odczytywane a¿ do
uzyskania  wystarczaj±cej ilo¶ci entropii:</p>
<ul>
<li></li>
Zawarto¶æ pliku podanego w opcji <em>RNDfile</em>.
<p></p>
<li></li>
Zawarto¶æ pliku o nazwie okre¶lonej przez zmienn± ¶rodowiskow±
RANDFILE, o ile jest ona ustawiona.
<p></p>
<li></li>
Plik .rnd umieszczony w katalogu domowym u¿ytkownika,
je¿eli zmienna RANDFILE nie jest ustawiona.
<p></p>
<li></li>
Plik podany w opcji '--with-random' w czasie konfiguracji programu.
<p></p>
<li></li>
Zawarto¶æ ekranu w systemie Windows.
<p></p>
<li></li>
Gniazdo egd, je¿eli u¿yta zosta³a opcja <em>EGD</em>.
<p></p>
<li></li>
Gniazdo egd podane w opcji '--with-egd-socket' w czasie konfiguracji programu.
<p></p>
<li></li>
Urz±dzenie /dev/urandom.
<p></p></ul>
<p>Wspó³czesne (&gt;=0.9.5a) wersje biblioteki <em>OpenSSL</em> automatycznie
zaprzestaj± ³adowania kolejnych danych w momencie uzyskania wystarczaj±cej
ilo¶ci entropii.  Wcze¶niejsze wersje biblioteki wykorzystaj± wszystkie
powy¿sze ¼ród³a, gdy¿ nie istnieje tam funkcja pozwalaj±ca okre¶liæ,
czy uzyskano ju¿ wystarczaj±co du¿o danych.</p>
<p>Warto zwróciæ uwagê, ¿e na maszynach z systemem Windows, na których
konsoli nie pracuje u¿ytkownik, zawarto¶æ ekranu nie jest wystarczaj±co
zmienna, aby zainicjowaæ PRNG.  W takim przypadku do zainicjowania
generatora nale¿y u¿yæ opcji <em>RNDfile</em>.</p>
<p>Plik <em>RNDfile</em> powinien zawieraæ dane losowe -- równie¿ w tym sensie,
¿e powinny byæ one inne przy ka¿dym uruchomieniu programu <strong>stunnel</strong>.
O ile nie u¿yta zosta³a opcja <em>RNDoverwrite</em> jest to robione
automatycznie.  Do rêcznego uzyskania takiego pliku u¿yteczna
mo¿e byæ komenda <em>openssl rand</em> dostarczana ze wspó³czesnymi
wersjami pakietu <em>OpenSSL</em>.</p>
<p>Jeszcze jedna istotna informacja -- je¿eli dostêpne jest urz±dzenie
<em>/dev/urandom</em> biblioteka <em>OpenSSL</em> ma zwyczaj zasilania nim PRNG w trakcie
sprawdzania stanu generatora.  W systemach z <em>/dev/urandom</em> urz±dzenie
to bêdzie najprawdopodobniej u¿yte, pomimo ¿e znajduje siê na samym koñcu
powy¿szej listy.  Jest to w³a¶ciwo¶æ biblioteki <em>OpenSSL</em>, a nie programu
<em>stunnel</em>.</p>
<p>
</p>
<hr />
<h1><a name="zobacz_równie¿">ZOBACZ RÓWNIE¯</a></h1>
<dl>
<dt><strong><a name="item_tcpd"><a href="#item_tcpd">tcpd(8)</a></a></strong><br />
</dt>
<dd>
biblioteka kontroli dostêpu do us³ug internetowych
</dd>
<p></p>
<dt><strong><a name="item_inetd"><a href="#item_inetd">inetd(8)</a></a></strong><br />
</dt>
<dd>
'super-serwer' internetowy
</dd>
<p></p>
<dt><strong><a name="item_http_3a_2f_2fstunnel_2emirt_2enet_2f"><em><a href="http://stunnel.mirt.net/">http://stunnel.mirt.net/</a></em></a></strong><br />
</dt>
<dd>
strona domowa programu <em>stunnel</em>
</dd>
<p></p>
<dt><strong><a name="item_http_3a_2f_2fwww_2estunnel_2eorg_2f"><em><a href="http://www.stunnel.org/">http://www.stunnel.org/</a></em></a></strong><br />
</dt>
<dd>
najczê¶ciej zadawane pytania na temat programu <em>stunnel</em>
</dd>
<p></p>
<dt><strong><a name="item_http_3a_2f_2fwww_2eopenssl_2eorg_2f"><em><a href="http://www.openssl.org/">http://www.openssl.org/</a></em></a></strong><br />
</dt>
<dd>
strona projektu <em>OpenSSL</em>
</dd>
<p></p></dl>
<p>
</p>
<hr />
<h1><a name="autor">AUTOR</a></h1>
<dl>
<dt><strong><a name="item_micha³_trojnara">Micha³ Trojnara</a></strong><br />
</dt>
<dd>
&lt;<em><a href="mailto:Michal.Trojnara@mirt.net">Michal.Trojnara@mirt.net</a></em>&gt;
</dd>
<p></p></dl>

</body>

</html>
